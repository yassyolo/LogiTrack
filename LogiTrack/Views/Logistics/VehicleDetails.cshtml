@model LogiTrack.Core.ViewModels.Vehicle.VehicleDetailsViewModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver Dashboard</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap">
    <link rel="stylesheet" href="~/css/site.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css">
    <script src="~/js/site.js"></script>
    <style>

        body {
            font-family: 'Roboto', sans-serif;
        }

        .delivery-details-container {
            width: 85%;
        }

        .card {
            box-shadow: 0 0 25px 1px #0000000f !important;
            padding: 17px;
            background-color: white;
        }

        .details-header {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
        }

        .delivery-image {
            width: 50px;
            height: auto;
            margin-right: 20px;
        }

        .details-header h2 {
            font-size: 19px;
            margin: 0;
        }

        h4 {
            margin: 10px 0;
        }

        .button-tabs {
            display: flex;
            border-bottom: 1px solid grey;
            margin-bottom: 15px;
        }

        .tab-button {
            padding: 10px 30px;
            border: none;
            cursor: pointer;
            display: inline-block;
            font-size: 15px;
            transition: background-color 0.3s;
            color: black;
            background-color: white;
        }

            .tab-button:focus,
            .tab-button:active {
                border-bottom: 2px solid #00aa87;
            }

        .btn {
            color: grey;
            border: none;
            cursor: pointer;
            margin: 0 5px;
            transition: background-color 0.3s;
        }

        hr {
            margin-bottom: 15px;
            margin-left: 10px;
        }

        .section {
            display: none;
            margin-left: 25px;
        }

            .section:not(.d-none) {
                display: block;
            }

        .addresses-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .address-column {
            display: flex;
            flex-direction: column;
        }

            .address-column h5 {
                margin-bottom: 10px;
            }

            .address-column p {
                margin: 5px 0;
            }

        .maps-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .map {
            width: 90%;
            height: 200px;
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .delivery-steps {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .step-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .step-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: gray;
        }

            .step-dot.completed {
                background-color: green;
            }

        .step-line {
            width: 3px;
            height: 50px;
            background-color: gray;
            margin: 0 auto;
        }

            .step-line.completed {
                background-color: green;
            }

        .step-text {
            text-align: center;
            margin-top: 8px;
        }

            .step-text img {
                width: 30px;
                height: 30px;
            }


        .movement-history {
            margin-top: 20px;
        }

        .movement-rows {
            display: flex;
            flex-direction: column;
        }

        .movement-row {
            display: flex;
            align-items: center;
            gap: 40px;
            padding: 10px 0;
        }

        .movement-event {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .movement-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: gray;
        }

        .event-line {
            width: 2px;
            height: 20px;
            background-color: gray;
            margin-top: 2px;
        }

        .movement-location, .movement-time {
            margin-left: 10px;
        }

        .vehicles-section-header, .address-column h4 {
            display: flex;
            margin-bottom: 20px;
            flex-direction: row;
        }

            .vehicles-section-header h4,
            .address-column h4, .metrics-header h4, .special-instructions h4,
            .status-header h4, .metrics h4 {
                font-size: 20px;
                color: #00aa87;
                font-weight: 500;
            }

        .address-column p, .status-header p {
            font-size: 14px;
            color: black;
            opacity: 80%;
        }

        .address-column strong {
            color: black;
        }

        .metrics-header {
            display: flex;
            flex-direction: row;
            gap: 300px;
            margin-bottom: 20px;
        }

        .status-header {
            display: flex;
            flex-direction: row;
            gap: 180px;
            margin-bottom: 20px;
        }

        .metrics {
            margin-top: 50px;
        }

        .standart-metrics-header-row {
            display: flex;
            flex-direction: row;
            margin-left: 40px;
            gap: 50px;
        }

        .standart-metrics-info-row {
            display: flex;
            flex-direction: row;
            background-color: #fbfbfb;
            margin-left: 40px;
            gap: 100px;
            white-space: nowrap;
            font-weight: 300;
            font-size: 14px;
            opacity: 80%;
        }

        .non-standart-metrics-header-row {
            display: flex;
            flex-direction: row;
            margin-left: 40px;
            gap: 70px;
        }

        .more-header-row {
            display: flex;
            flex-direction: row;
            margin-left: 40px;
            gap: 50px;
        }

        .non-standart-metrics-info-row {
            display: flex;
            flex-direction: row;
            background-color: #fbfbfb;
            margin-left: 40px;
            gap: 100px;
            font-weight: 300;
            font-size: 14px;
            opacity: 80%;
        }

        .more-info-row {
            display: flex;
            flex-direction: row;
            background-color: #fbfbfb;
            margin-left: 40px;
            gap: 60px;
            font-weight: 300;
            font-size: 14px;
            opacity: 80%;
        }

        .filtered-deliveries-container {
            background-color: #ffff;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .quick-search-form {
            padding-top: 20px;
            margin-left: 20px;
        }

            .quick-search-form .form-group {
                width: 55%;
            }

        .delivery-header {
            display: flex;
            justify-content: space-between;
            background-color: #ffffff;
            padding: 30px;
            font-weight: bold;
            font-size: 0.90rem;
            width: 90%;
        }

        .delivery-card {
            background-color: white;
            font-size: 0.80rem;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease;
            position: relative;
            overflow: hidden;
        }

            .delivery-card:nth-child(even) {
                background-color: #F5F5F7;
            }

        .delivery-info {
            display: flex;
            width: 90%;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
            margin-top: 28px;
            margin-left: 30px;
            height: 5px;
        }

        .delivery-metrics {
            display: none;
            margin-top: 10px;
            background-color: #f1f8ff;
            width: 100%;
            transition: background-color 0.3s ease;
        }

            .delivery-metrics p {
                margin-left: 210px;
            }

        .delivery-card:hover .delivery-metrics {
            display: flex;
            background-color: #54C392;
            opacity: 1;
        }

        .delivery-card:hover {
            background-color: #73EC8B;
            opacity: 90%;
        }

        .no-found {
            padding: 15px;
            color: #00aa87;
            text-align: center;
        }

        .address {
            width: 140px;
            flex-wrap: wrap;
        }

    </style>

</head>

<body>
    <header class="header">
        <div class="logo-name">
            <div class="company-logo">
                <img src="https://via.placeholder.com/50" alt="Company Logo">
            </div>
            <div class="company-name">LogiTrack</div>
        </div>
        <div class="profile-dropdown">
            <button onclick="toggleDropdown()">
                <i class="bi bi-person-circle"></i>
                <span class="arrow">&#x25BC;</span>
            </button>
            <div class="profile-dropdown-menu" id="profileDropdown">
                <a asp-action="Details" asp-controller="Driver">Personal details</a>
                <a asp-action="LicenseDetails" asp-controller="Driver">License</a>
                <a asp-action="Logout" asp-controller="Home">Logout</a>
            </div>
        </div>
    </header>
    <aside class="sidebar">
        <ul>
            <li><a asp-action="Dashboard" asp-controller="Driver"><i class="bi bi-house-door"></i> Dashboard</a></li>
            <li>
                <a asp-action="SearchDelivery" asp-controller="Driver"><i class="bi bi-journal"></i> New Delivery</a>
            </li>
            <li>
                <a asp-action="SearchDeliveries" asp-controller="Driver"><i class="bi bi-truck"></i> Deliveries</a>
            </li>
        </ul>
    </aside>

    <div class="main-content">
        <div class="delivery-details-container">
            <div class="card">
                <div class="details-header">
                    <img src="https://via.placeholder.com/100" alt="Delivery Image" class="delivery-image">
                    <h2><b>@Model.RegistrationNumber</b></h2>
                </div>

                <div class="button-tabs">
                    <button class="tab-button" id="vehicleBtn">INFO</button>
                    <button class="tab-button" id="addressesBtn">DELIVERIES</button>
                    <button class="tab-button" id="metricsBtn">MAINTENANCE</button>
                    <button class="tab-button" id="statusBtn">METRICS</button>
                </div>

                <div id="vehicleSection" class="section d-none">
                    <div class="vehicles-section-header">
                        @*<img src="https://via.placeholder.com/100" alt="Delivery Image" class="delivery-image">*@
                        <h4><b>Vehicle details</b></h4>
                    </div>
                    <p><strong>Registration Number:</strong> @Model.RegistrationNumber</p>
                    <p><strong>Vehicle Type:</strong> @Model.VehicleType</p>
                    <p><strong>Purchase price:</strong> @Model.PurchasePrice</p>
                    <p><strong>Constant expenses:</strong> @Model.ContantsExpenses</p>

                    <h4><b>Status</b></h4>
                    <p><strong>Vehicle Type:</strong> @Model.VehicleStatus</p>
                </div>

                <div id="addressesSection" class="section d-none">
                    <div class="filtered-deliveries-container">

                        <div class="delivery-header">
                            <span>Ref No</span>
                            <span>Origin</span>
                            <span>Destination</span>
                            <span>Expected Date</span>
                            <span>Price</span>
                            <span>Delivered</span>
                            <span>Paid</span>
                        </div>
                        @if (Model.Deliveries.Any())
                        {
                            <div class="delivery-list">
                                @foreach (var delivery in Model.Deliveries)
                                {
                                    <div class="delivery-card">
                                        <div class="delivery-info">
                                            <a asp-action="DeliveryDetails" asp-controller="Accountant" asp-route-id="@delivery.Id" style="text-decoration:none; color:inherit;"><span>@delivery.ReferenceNumber</span></a>
                                            <span class="address">@delivery.PickupAddress</span>
                                            <span class="address">@delivery.DeliveryAddress</span>

                                            <span>@delivery.ExpectedDeliveryDate</span>
                                            <span>@delivery.FinalPrice</span>
                                            <span>
                                                @if (delivery.IsDelivered)
                                                {
                                                    <p style="color: #00aa87;">Yes</p>
                                                }
                                            </span>
                                            <span>
                                                @if (delivery.IsPaid)
                                                {
                                                    <p style="color: #00aa87;">Yes</p>
                                                }
                                            </span>
                                        </div>
                                        <div class="delivery-metrics">
                                            <p><b>Packs:</b> @delivery.TotalItems</p>
                                            <p><b>Weight:</b> @delivery.TotalWeight</p>
                                            <p><b>Volume:</b> @delivery.TotalVolume</p>
                                        </div>
                                    </div>
                                }
                            </div>
                        }
                        else
                        {
                            <p class="no-found">No deliveries found matching the search criteria.</p>
                        }
                    </div>
                </div>

                <div id="metricsSection" class="section  d-none">
                    <div class="metrics-header">
                        <div class="metrics-header-row">
                            <h4><b>Fuel consumption per 100km</b></h4>
                            <p>@Model.FuelConsumptionPer100Km</p>
                        </div>
                        </div>
                        <div class="metrics">
                            <h4><b>Standard Metrics</b></h4>
                        </div>
                        <div class="standart-metrics-header-row">
                            <p><b>Length</b></p>
                            <p><b>Width</b></p>
                            <p><b>Height</b></p>
                            <p><b>Max weight capacity</b></p>

                        </div>
                        <div class="standart-metrics-info-row">
                            <p>@Model.Length</p>
                            <p>@Model.Width</p>
                            <p>@Model.Height</p>
                            <p>@Model.MaxWeightCapacity</p>

                        </div>
                        <div class="metrics">
                            <h4><b>Non-Standart Metrics</b></h4>
                        </div>


                        <div class="non-standart-metrics-header-row">
                            <p><b>Euro pallet capacity</b></p>
                            <p><b>Industrial pallet capacity</b></p>
                            <p><b>Stackable</b></p>
                        </div>
                        <div class="non-standart-metrics-info-row">
                            <p>@Model.EuroPalletCapacity</p>
                            <p>@Model.IndustrialPalletCapacity</p>
                            <p>@Model.ArePalletsStackable</p>

                        </div>


                    </div>

                    <div id="statusSection" class="section d-none">
                        <div class="status-header">
                            <div class="status-header-row">
                                <h4>Last year maintenance</h4>
                                <p>@Model.LastYearMaintenance</p>
                            </div>
                            <div class="status-header-row">
                                <h4>Days till yearly maintenance</h4>
                                <p>@Model.DaysTillMaintenance</p>
                            </div>
                        </div>
                        <div class="status-header-row">
                            <h4>Kilometers driven</h4>
                            <p>@Model.KilometersDriven</p>
                        </div>
                        <div class="status-header-row">
                            <h4>Kilometers till part changing</h4>
                            <p>@Model.KilometersLeftToChangeParts</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            $(document).ready(function () {
                $('#vehicleBtn').click(function () {
                    showSection('#vehicleSection');
                });
                $('#addressesBtn').click(function () {
                    showSection('#addressesSection');
                    initPickupMap();
                    initDeliveryMap();
                });
                $('#metricsBtn').click(function () {
                    showSection('#metricsSection');
                });
                $('#statusBtn').click(function () {
                    showSection('#statusSection');
                });

                function showSection(sectionId) {
                    $('.section').addClass('d-none');
                    $(sectionId).removeClass('d-none');
                }
            });
        </script>
</body>
</html>

